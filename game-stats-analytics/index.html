<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameStats Analytics</title>
    
    <!-- Apple Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Apple-style Navigation -->
    <header class="apple-navbar">
        <nav class="container">
            <div class="nav-content">
                <div class="nav-brand">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" fill="currentColor"/>
                        <circle cx="12" cy="19" r="2" fill="currentColor"/>
                    </svg>
                    <span>GameStats Analytics</span>
                </div>
                <div class="nav-menu" id="navMenu">
                    <a href="#" class="nav-item active">Inicio</a>
                    <a href="upload.html" class="nav-item">Cargar Juegos</a>
                    <a href="#" class="nav-item" id="clearDataBtn">Limpiar Datos</a>
                </div>
                <div class="nav-toggle" id="navToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </nav>
    </header>

    <!-- Apple-style Hero Section -->
    <main class="main-content">
        <section class="hero-section">
            <div class="container">
                <div class="hero-content">
                    <h1 class="hero-title">Analiza tus Juegos <span class="text-gradient">Favoritos</span></h1>
                    <p class="hero-subtitle">Estadísticas detalladas y datos actualizados de múltiples tiendas digitales</p>
                    
                    <!-- Apple-style Search -->
                    <div class="search-container">
                        <div class="search-box">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 21L16.514 16.506L21 21ZM19 10.5C19 15.194 15.194 19 10.5 19C5.806 19 2 15.194 2 10.5C2 5.806 5.806 2 10.5 2C15.194 2 19 5.806 19 10.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <input type="text" id="searchInput" placeholder="Buscar juegos...">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="content-section">
            <div class="container">
                <!-- Loading Spinner -->
                <div id="loadingSpinner" class="loading-container" style="display: none;">
                    <div class="apple-spinner">
                        <div class="spinner-circle"></div>
                    </div>
                    <p>Cargando juegos...</p>
                </div>

                <!-- Games Count -->
                <div id="gamesCount" class="games-count">
                    <p>Total de juegos: <span id="totalGames">0</span></p>
                </div>

                <!-- Games Grid -->
                <div id="gamesContainer" class="games-grid">
                    <!-- Game cards will be inserted here -->
                </div>

                <!-- No Games Message -->
                <div id="noGamesMessage" class="empty-state" style="display: none;">
                    <div class="empty-icon">
                        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="6" width="18" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M8 10.5L10.5 13L16 7.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <h3>No hay juegos disponibles</h3>
                    <p>Carga un archivo TXT con nombres de juegos para comenzar</p>
                    <a href="upload.html" class="apple-button">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        Cargar Juegos
                    </a>
                </div>
            </div>
        </section>
    </main>

    <!-- Apple-style Footer -->
    <footer class="apple-footer">
        <div class="container">
            <p>&copy; 2024 GameStats Analytics. Datos proporcionados por RAWG API</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        let allGames = [];

        // Load games from LocalStorage
        function loadGames() {
            const loadingSpinner = document.getElementById('loadingSpinner');
            const gamesContainer = document.getElementById('gamesContainer');
            const noGamesMessage = document.getElementById('noGamesMessage');
            const totalGamesSpan = document.getElementById('totalGames');

            try {
                loadingSpinner.style.display = 'block';
                gamesContainer.innerHTML = '';

                // Get games from LocalStorage
                const gamesData = localStorage.getItem('gamesData');
                if (gamesData) {
                    allGames = JSON.parse(gamesData);
                } else {
                    allGames = [];
                }

                loadingSpinner.style.display = 'none';

                if (allGames.length === 0) {
                    noGamesMessage.style.display = 'block';
                    gamesContainer.style.display = 'none';
                    document.getElementById('gamesCount').style.display = 'none';
                } else {
                    noGamesMessage.style.display = 'none';
                    gamesContainer.style.display = 'flex';
                    document.getElementById('gamesCount').style.display = 'block';
                    displayGames(allGames);
                }

                totalGamesSpan.textContent = allGames.length;

            } catch (error) {
                console.error('Error loading games:', error);
                loadingSpinner.style.display = 'none';
                alert('Error al cargar los juegos. Por favor, intenta de nuevo.');
            }
        }

        // Display games
        function displayGames(games) {
            const gamesContainer = document.getElementById('gamesContainer');
            gamesContainer.innerHTML = '';

            games.forEach(game => {
                const card = createGameCard(game);
                gamesContainer.innerHTML += card;
            });
        }

        // Create game card HTML
        function createGameCard(game) {
            const platforms = game.platforms ? game.platforms.slice(0, 4).map(p => {
                const icon = getPlatformIcon(p);
                return `<i class="bi bi-${icon}" title="${p}"></i>`;
            }).join(' ') : '';

            const genres = game.genres ? game.genres.slice(0, 3).join(', ') : 'N/A';
            
            const price = game.price || 'Consultar tienda';
            const discount = game.discount ? `<span class="discount-badge">-${game.discount}%</span>` : '';

            return `
                <div class="game-card">
                    <div class="game-image-container">
                        <img src="${game.image || 'https://via.placeholder.com/300x200?text=No+Image'}" 
                             class="game-image" 
                             alt="${game.name}"
                             onerror="this.src='https://via.placeholder.com/300x200?text=No+Image'">
                        ${discount}
                    </div>
                    <div class="game-content">
                        <h3 class="game-title">${game.name}</h3>
                        <p class="game-genre">${genres}</p>
                        <div class="game-platforms">
                            ${platforms}
                        </div>
                        <div class="game-footer">
                            <span class="game-price">${price}</span>
                            <span class="game-rating">
                                <i class="bi bi-star-fill"></i>
                                ${game.rating || 'N/A'}
                            </span>
                        </div>
                    </div>
                </div>
            `;
        }

        // Get platform icon
        function getPlatformIcon(platform) {
            const platformLower = platform.toLowerCase();
            if (platformLower.includes('playstation') || platformLower.includes('ps')) return 'playstation';
            if (platformLower.includes('xbox')) return 'xbox';
            if (platformLower.includes('nintendo') || platformLower.includes('switch')) return 'nintendo-switch';
            if (platformLower.includes('pc') || platformLower.includes('windows')) return 'windows';
            if (platformLower.includes('mac')) return 'apple';
            if (platformLower.includes('linux')) return 'ubuntu';
            return 'controller';
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', () => {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            if (searchTerm.trim() === '') {
                displayGames(allGames);
                document.getElementById('totalGames').textContent = allGames.length;
            } else {
                const filteredGames = allGames.filter(game => 
                    game.name.toLowerCase().includes(searchTerm)
                );
                displayGames(filteredGames);
                document.getElementById('totalGames').textContent = filteredGames.length;
            }
        });

        // Clear all data
        document.getElementById('clearDataBtn').addEventListener('click', (e) => {
            e.preventDefault();
            if (confirm('¿Estás seguro de que quieres eliminar todos los juegos guardados?')) {
                localStorage.removeItem('gamesData');
                allGames = [];
                loadGames();
                alert('Datos eliminados correctamente');
            }
        });

        // Load games on page load
        window.addEventListener('load', loadGames);
    </script>
</body>
</html>